@model IEnumerable<PhanLaiAnhTuan_Lab03.Models.Product>
@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = "Trang chủ";
    string currentSearch = ViewBag.CurrentSearch as string;

}

<style>
    /* ==============================================
       🎨 PROFESSIONAL PET STORE DESIGN
       ============================================== */
    
    :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        --card-shadow-hover: 0 16px 64px rgba(0, 0, 0, 0.15);
        --border-radius: 16px;
        --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
    }

    /* ==============================================
       🎯 HERO SECTION
       ============================================== */
    .hero-section {
        background: var(--primary-gradient);
        padding: 3rem 0;
        margin-bottom: 4rem;
        position: relative;
        overflow: hidden;
    }

    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.15"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.15"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>') repeat;
        opacity: 0.3;
    }

    .promo-slider {
        border-radius: 24px;
        overflow: hidden;
        box-shadow: var(--card-shadow);
        position: relative;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .carousel-item img {
        filter: brightness(0.9) contrast(1.1);
    }

    .carousel-caption {
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        padding: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .carousel-control-prev-icon,
    .carousel-control-next-icon {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 50%;
        width: 3.5rem;
        height: 3.5rem;
        border: 1px solid rgba(0, 0, 0, 0.1);
    }

    /* ==============================================
       🔍 SEARCH & FILTER SECTIONS
       ============================================== */
    .search-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 2.5rem;
        border-radius: var(--border-radius);
        margin-bottom: 2rem;
        box-shadow: var(--card-shadow);
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        overflow: hidden;
    }

    .search-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--primary-gradient);
    }

    .filter-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 2rem;
        border-radius: var(--border-radius);
        box-shadow: var(--card-shadow);
        margin-bottom: 3rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        position: relative;
        overflow: hidden;
    }

    .filter-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--success-gradient);
    }

    /* ==============================================
       🛍️ PRODUCT CARDS
       ============================================== */
    .product-card {
        border: none;
        border-radius: 20px;
        transition: var(--transition);
        box-shadow: var(--card-shadow);
        overflow: hidden;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        position: relative;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .product-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
        opacity: 0;
        transition: var(--transition);
        z-index: 1;
    }

    .product-card:hover {
        transform: translateY(-12px) scale(1.02);
        box-shadow: var(--card-shadow-hover);
    }

    .product-card:hover::before {
        opacity: 1;
    }

    .product-image {
        position: relative;
        overflow: hidden;
        border-radius: 16px 16px 0 0;
    }

    .product-image img {
        transition: var(--transition);
        filter: brightness(0.95) contrast(1.05);
    }

    .product-card:hover .product-image img {
        transform: scale(1.15);
        filter: brightness(1.05) contrast(1.1);
    }

    .product-image::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        opacity: 0;
        transition: var(--transition);
    }

    .product-card:hover .product-image::after {
        opacity: 1;
    }

    .card-body {
        position: relative;
        z-index: 2;
    }

    .price-tag {
        background: var(--warning-gradient);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 25px;
        font-weight: 700;
        font-size: 1.1rem;
        display: inline-block;
        box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
        position: relative;
        overflow: hidden;
    }

    .price-tag::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s ease;
    }

    .product-card:hover .price-tag::before {
        left: 100%;
    }

    /* ==============================================
       🎯 BUTTONS & INTERACTIONS
       ============================================== */
    .btn-custom-primary {
        background: var(--primary-gradient);
        border: none;
        border-radius: 30px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        font-size: 1rem;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        position: relative;
        overflow: hidden;
    }

    .btn-custom-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s ease;
    }

    .btn-custom-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .btn-custom-primary:hover::before {
        left: 100%;
    }

    .btn-add-cart {
        background: var(--success-gradient);
        border: none;
        border-radius: 30px;
        color: white;
        font-weight: 600;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
        position: relative;
        overflow: hidden;
    }

    .btn-add-cart::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s ease;
    }

    .btn-add-cart:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(17, 153, 142, 0.4);
        color: white;
    }

    .btn-add-cart:hover::before {
        left: 100%;
    }

    .btn-outline-primary {
        border: 2px solid transparent;
        background: linear-gradient(white, white) padding-box, var(--primary-gradient) border-box;
        color: #667eea;
        border-radius: 30px;
        font-weight: 600;
        transition: var(--transition);
    }

    .btn-outline-primary:hover {
        background: var(--primary-gradient);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
    }

    /* ==============================================
       📝 FORM ELEMENTS
       ============================================== */
    .form-control,
    .form-select {
        border: 2px solid rgba(102, 126, 234, 0.1);
        border-radius: 12px;
        padding: 0.75rem 1rem;
        font-size: 1rem;
        transition: var(--transition);
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
    }

    .form-control:focus,
    .form-select:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.15);
        background: white;
    }

    .input-group-text {
        background: white;
        border: 2px solid rgba(102, 126, 234, 0.1);
        border-right: none;
    }

    /* ==============================================
       🎨 SECTION TITLES & TYPOGRAPHY
       ============================================== */
    .section-title {
        color: #2c3e50;
        font-weight: 800;
        font-size: 2rem;
        margin-bottom: 1rem;
        position: relative;
        display: inline-block;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 60px;
        height: 4px;
        background: var(--primary-gradient);
        border-radius: 2px;
    }

    .section-subtitle {
        color: #6c757d;
        font-size: 1.1rem;
        font-weight: 400;
        margin-bottom: 3rem;
    }

    /* ==============================================
       ✨ ANIMATIONS & EFFECTS
       ============================================== */
    .fade-in {
        opacity: 0;
        transform: translateY(40px);
        transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .fade-in.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .floating-icon {
        animation: float 3s ease-in-out infinite;
    }

    @@keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    /* ==============================================
       📱 RESPONSIVE DESIGN
       ============================================== */
    @@media (max-width: 768px) {
        .hero-section {
            padding: 2rem 0;
        }
        
        .search-section,
        .filter-card {
            padding: 1.5rem;
        }
        
        .section-title {
            font-size: 1.5rem;
        }
        
        .product-card:hover {
            transform: translateY(-6px) scale(1.01);
        }
    }

    /* ==============================================
       🎯 LOADING STATES
       ============================================== */
    .loading-shimmer {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: shimmer 2s infinite;
    }

    @@keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }

    /* ==============================================
       🌟 SPECIAL EFFECTS
       ============================================== */
    .glass-effect {
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
    }

    .gradient-text {
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
</style>

<!-- 🎨 HERO SECTION với SLIDER -->
<div class="hero-section">
    <div class="container">
        <div id="promoSlider" class="carousel slide promo-slider mx-auto" data-bs-ride="carousel" style="max-width: 1200px; height: 400px;">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#promoSlider" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#promoSlider" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#promoSlider" data-bs-slide-to="2"></button>
            </div>

            <div class="carousel-inner h-100">
                <div class="carousel-item active h-100">
                    <img src="~/images/hinh1.png" class="d-block w-100 h-100" style="object-fit: cover;" alt="Khuyến mãi 1">
                    <div class="carousel-caption d-none d-md-block">
                        <h2 class="fw-bold mb-3">🐾 Chào mừng đến với Pet Paradise</h2>
                        <p class="fs-5">Tìm kiếm người bạn hoàn hảo cho gia đình bạn</p>
                    </div>
                </div>
                <div class="carousel-item h-100">
                    <img src="~/images/hinh3.jpeg" class="d-block w-100 h-100" style="object-fit: cover;" alt="Khuyến mãi 2">
                    <div class="carousel-caption d-none d-md-block">
                        <h2 class="fw-bold mb-3">🎉 Ưu đãi đặc biệt</h2>
                        <p class="fs-5">Giảm giá lên đến 30% cho tất cả thú cưng</p>
                    </div>
                </div>
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#promoSlider" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#promoSlider" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
            </button>
        </div>
    </div>
</div>

<div class="container">
    <!-- 🔍 TÌM KIẾM -->
    <div class="search-section fade-in">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h4 class="mb-4 gradient-text">
                    <i class="bi bi-search me-2"></i>Tìm kiếm thú cưng yêu thích
                </h4>
                <form method="get" asp-action="Index" asp-controller="Home">
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-white border-end-0">
                            <i class="bi bi-search text-primary"></i>
                        </span>
                        <input type="text" id="searchInput" name="searchString" value="@currentSearch"
                               class="form-control border-start-0 ps-2"
                               placeholder="Nhập tên thú cưng bạn muốn tìm..." />
                        <button type="submit" class="btn btn-custom-primary">
                            <i class="bi bi-search me-2"></i>Tìm kiếm
                        </button>
                    </div>
                </form>
            </div>
            <div class="col-lg-4 text-center">
                <div class="floating-icon">
                    <i class="bi bi-heart-fill text-danger" style="font-size: 4rem;"></i>
                </div>
                <p class="text-muted mt-3 fs-6">Tìm kiếm người bạn đồng hành hoàn hảo</p>
            </div>
        </div>
    </div>


    <!-- 🎛️ BỘ LỌC -->
    <div class="filter-card fade-in">
        <h5 class="section-title mb-4">Bộ lọc và sắp xếp</h5>
        <form method="get" asp-action="Index" onchange="this.submit()">
            <div class="row g-4">
                <div class="col-lg-6">
                    <label class="form-label fw-semibold mb-3">
                        <i class="bi bi-funnel-fill text-primary me-2"></i>Lọc theo loài thú cưng
                    </label>
                    <select name="categoryId" class="form-select form-select-lg" asp-items="ViewBag.CategoryList">
                        <option value="">🐾 Tất cả thú cưng</option>
                    </select>
                </div>
                <div class="col-lg-6">
                    <label class="form-label fw-semibold mb-3">
                        <i class="bi bi-sort-down-alt text-primary me-2"></i>Sắp xếp theo giá
                    </label>
                    <select name="sortOrder" class="form-select form-select-lg" asp-items="ViewBag.SortList">
                        <option value="">💰 Mặc định</option>
                    </select>
                </div>
            </div>
        </form>
    </div>

    <!-- 🏪 DANH SÁCH SẢN PHẨM -->
    <div class="mb-5">
        <h2 class="section-title">Thú cưng dành cho bạn</h2>
        <p class="section-subtitle">Khám phá những người bạn đáng yêu đang chờ đón gia đình mới</p>
    </div>

    <div class="row g-4">
        @foreach (var item in Model)
        {
            <div class="col-xl-3 col-lg-4 col-md-6">
                <div class="card product-card h-100 fade-in">
                    <div class="product-image" style="height: 250px;">
                        <img src="@Url.Content("~/images/" + item.ImageUrl)"
                             class="card-img-top w-100 h-100"
                             style="object-fit: cover;"
                             alt="@item.Name" />
                    </div>

                    <div class="card-body d-flex flex-column p-4">
                        <h5 class="card-title mb-3 fw-bold" title="@item.Name">
                            <i class="bi bi-heart-fill text-danger me-2"></i>@item.Name
                        </h5>

                        <div class="mb-4">
                            <span class="price-tag">@item.Price.ToString("C")</span>
                        </div>

                        <div class="d-flex flex-column gap-3 mt-auto">
                            <a asp-controller="Home" asp-action="Details" asp-route-id="@item.Id"
                               class="btn btn-outline-primary">
                                <i class="bi bi-eye me-2"></i>Xem chi tiết
                            </a>

                            <form asp-controller="ShoppingCart" asp-action="AddToCart" method="post">
                                <input type="hidden" name="productId" value="@item.Id" />
                                <input type="hidden" name="quantity" value="1" />
                                <button type="submit" class="btn btn-add-cart w-100">
                                    <i class="bi bi-cart-plus me-2"></i>Thêm vào giỏ hàng
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

    @if (!Model.Any())
    {
        <div class="text-center py-5 glass-effect rounded-4 p-5">
            <div class="floating-icon">
                <i class="bi bi-search" style="font-size: 5rem; color: #dee2e6;"></i>
            </div>
            <h3 class="mt-4 text-muted fw-bold">Không tìm thấy thú cưng nào</h3>
            <p class="text-muted fs-5 mb-4">Hãy thử tìm kiếm với từ khóa khác hoặc xem tất cả sản phẩm</p>
            <a href="@Url.Action("Index")" class="btn btn-custom-primary btn-lg">
                <i class="bi bi-house-heart me-2"></i>Xem tất cả thú cưng
            </a>
        </div>
    }
</div>

@section Scripts {
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- jQuery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />

    <style>
        .autocomplete-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .autocomplete-delete {
            color: red;
            font-weight: bold;
            cursor: pointer;
            margin-left: 8px;
        }
    </style>

    <script>
        $(document).ready(function () {
            $("#searchInput").autocomplete({
                source: function (request, response) {
                    const term = request.term || "";
                    let history = JSON.parse(localStorage.getItem("searchHistory")) || [];

                    const filteredHistory = history
                        .filter(item => item.toLowerCase().includes(term.toLowerCase()))
                        .map(item => ({ label: item, value: item, isHistory: true }));

                    $.ajax({
                        url: "/Home/GetSuggestions",
                        type: "GET",
                        data: { term: term },
                        dataType: "json",
                        success: function (serverData) {
                            const filteredServer = serverData
                                .filter(item => !history.includes(item.value))
                                .map(item => ({ ...item, isHistory: false }));

                            const finalSuggestions = [...filteredHistory, ...filteredServer];
                            response(finalSuggestions);
                        },
                        error: function () {
                            response(filteredHistory);
                        }
                    });
                },
                minLength: 0,
                select: function (event, ui) {
                    if ($(event.originalEvent.target).hasClass('autocomplete-delete')) {
                        return false; // Bấm dấu x thì không thực hiện select
                    }

                    const keyword = ui.item.value;
                    $("#searchInput").val(keyword);
                    $("#searchInput").closest("form").submit();

                    saveToHistory(keyword);
                    return false;
                }
            }).data("ui-autocomplete")._renderItem = function (ul, item) {
                const $li = $("<li>").addClass("autocomplete-item");

                const $label = $("<div>")
                    .html((item.isHistory ? "<i class='bi bi-clock-history me-1 text-secondary'></i>" : "") + item.label)
                    .addClass("p-2")
                    .css("flex-grow", "1");

                $li.append($label);

                if (item.isHistory) {
                    const $deleteBtn = $("<span>")
                        .addClass("autocomplete-delete p-2")
                        .text("×")
                        .click(function (e) {
                            e.stopPropagation();
                            removeFromHistory(item.label);
                            $li.remove();
                        });

                    $li.append($deleteBtn);
                }

                return $li.appendTo(ul);
            };

            $("#searchInput").on("focus", function () {
                if ($(this).val() === "") {
                    $(this).autocomplete("search", "");
                }
            });

            $("#searchInput").closest("form").on("submit", function () {
                const keyword = $("#searchInput").val().trim();
                if (keyword.length > 0) {
                    saveToHistory(keyword);
                }
            });

            function saveToHistory(keyword) {
                let history = JSON.parse(localStorage.getItem("searchHistory")) || [];
                history = history.filter(item => item.toLowerCase() !== keyword.toLowerCase());
                history.unshift(keyword);
                history = history.slice(0, 5);
                localStorage.setItem("searchHistory", JSON.stringify(history));
            }

            function removeFromHistory(keyword) {
                let history = JSON.parse(localStorage.getItem("searchHistory")) || [];
                history = history.filter(item => item.toLowerCase() !== keyword.toLowerCase());
                localStorage.setItem("searchHistory", JSON.stringify(history));
            }

            // === Các đoạn script hiện có của bạn ===
            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.classList.add('visible');
                        }, index * 100);
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transition = 'all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                });
                card.addEventListener('mouseleave', function () {
                    this.style.transition = 'all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                });
            });

            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            document.querySelectorAll('form').forEach(form => {
                form.addEventListener('submit', function () {
                    const submitBtn = this.querySelector('button[type="submit"]');
                    if (submitBtn) {
                        submitBtn.innerHTML = '<i class="bi bi-arrow-clockwise"></i> Đang xử lý...';
                        submitBtn.disabled = true;
                    }
                });
            });

            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.classList.remove('loading-shimmer');
                                imageObserver.unobserve(img);
                            }
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    img.classList.add('loading-shimmer');
                    imageObserver.observe(img);
                });
            }
        });
    </script>
}



<!-- Chatbox -->
<div id="chatBox" class="chat-box d-none">
    <form asp-action="Chat" method="post">
        <div id="chatHistory">
            @if (ViewBag.History != null)
            {
                foreach (var item in ViewBag.History)
                {
                    <div class="chat-bubble user"><strong>Bạn:</strong> @item.User</div>
                    <div class="chat-bubble ai"><strong>AI:</strong> @item.AI</div>
                }
            }
        </div>
        <textarea name="userMessage" class="form-control mt-2" placeholder="Nhập tin nhắn..." required></textarea>
        <button type="submit" class="btn btn-primary mt-2 w-100">Gửi</button>
    </form>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const toggleBtn = document.getElementById("chatToggleBtn");
        const chatBox = document.getElementById("chatBox");

        toggleBtn.addEventListener("click", function () {
            chatBox.classList.toggle("d-none");
        });
    });
</script>
